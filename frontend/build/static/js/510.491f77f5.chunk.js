"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[510],{3863:(e,t,n)=>{n.d(t,{A:()=>o});n(9950);var a=n(39886),i=n(44414);function o(e){return(0,i.jsx)(a.A,{variant:"h5",color:"primary",gutterBottom:!0,children:e.children})}},5386:(e,t,n)=>{n.d(t,{A:()=>p});var a=n(80045),i=n(58168),o=n(9950),s=n(2803),l=n(64620),r=n(52521),c=n(37751),d=n(96287),u=n(49739),m=o.forwardRef(function(e,t){var n,l,c=e.align,m=void 0===c?"inherit":c,p=e.classes,h=e.className,A=e.component,x=e.padding,g=e.scope,f=e.size,v=e.sortDirection,y=e.variant,j=(0,a.A)(e,["align","classes","className","component","padding","scope","size","sortDirection","variant"]),b=o.useContext(d.A),R=o.useContext(u.A),N=R&&"head"===R.variant;A?(l=A,n=N?"columnheader":"cell"):l=N?"th":"td";var C=g;!C&&N&&(C="col");var w=x||(b&&b.padding?b.padding:"normal"),E=f||(b&&b.size?b.size:"medium"),T=y||R&&R.variant,k=null;return v&&(k="asc"===v?"ascending":"descending"),o.createElement(l,(0,i.A)({ref:t,className:(0,s.A)(p.root,p[T],h,"inherit"!==m&&p["align".concat((0,r.A)(m))],"normal"!==w&&p["padding".concat((0,r.A)(w))],"medium"!==E&&p["size".concat((0,r.A)(E))],"head"===T&&b&&b.stickyHeader&&p.stickyHeader),"aria-sort":k,role:n,scope:C},j))});const p=(0,l.A)(function(e){return{root:(0,i.A)({},e.typography.body2,{display:"table-cell",verticalAlign:"inherit",borderBottom:"1px solid\n    ".concat("light"===e.palette.type?(0,c.a)((0,c.X4)(e.palette.divider,1),.88):(0,c.e$)((0,c.X4)(e.palette.divider,1),.68)),textAlign:"left",padding:16}),head:{color:e.palette.text.primary,lineHeight:e.typography.pxToRem(24),fontWeight:e.typography.fontWeightMedium},body:{color:e.palette.text.primary},footer:{color:e.palette.text.secondary,lineHeight:e.typography.pxToRem(21),fontSize:e.typography.pxToRem(12)},sizeSmall:{padding:"6px 24px 6px 16px","&:last-child":{paddingRight:16},"&$paddingCheckbox":{width:24,padding:"0 12px 0 16px","&:last-child":{paddingLeft:12,paddingRight:16},"& > *":{padding:0}}},paddingCheckbox:{width:48,padding:"0 0 0 4px","&:last-child":{paddingLeft:0,paddingRight:4}},paddingNone:{padding:0,"&:last-child":{padding:0}},alignLeft:{textAlign:"left"},alignCenter:{textAlign:"center"},alignRight:{textAlign:"right",flexDirection:"row-reverse"},alignJustify:{textAlign:"justify"},stickyHeader:{position:"sticky",top:0,left:0,zIndex:2,backgroundColor:e.palette.background.default}}},{name:"MuiTableCell"})(m)},33043:(e,t,n)=>{var a=n(24994),i=n(6305);t.A=void 0;var o=i(n(9950)),s=(0,a(n(53209)).default)(o.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM8 9h8v10H8V9zm7.5-5l-1-1h-5l-1 1H5v2h14V4z"}),"DeleteOutline");t.A=s},37874:(e,t,n)=>{n.d(t,{A:()=>m});var a=n(58168),i=n(80045),o=n(9950),s=n(2803),l=n(64620),r=n(49739),c={variant:"head"},d="thead",u=o.forwardRef(function(e,t){var n=e.classes,l=e.className,u=e.component,m=void 0===u?d:u,p=(0,i.A)(e,["classes","className","component"]);return o.createElement(r.A.Provider,{value:c},o.createElement(m,(0,a.A)({className:(0,s.A)(n.root,l),ref:t,role:m===d?null:"rowgroup"},p)))});const m=(0,l.A)({root:{display:"table-header-group"}},{name:"MuiTableHead"})(u)},38847:(e,t,n)=>{n.d(t,{A:()=>s});n(9950);var a=n(69994),i=n(44414);const o=(0,a.A)(e=>({contactsHeader:{display:"flex",alignItems:"center",padding:"0px 6px 6px 6px"}})),s=e=>{let{children:t}=e;const n=o();return(0,i.jsx)("div",{className:n.contactsHeader,children:t})}},42239:(e,t,n)=>{n.d(t,{A:()=>c});n(9950);var a=n(5386),i=n(92560),o=n(20906),s=n(69994),l=n(44414);const r=(0,s.A)(e=>({customTableCell:{display:"flex",alignItems:"center",justifyContent:"center"}})),c=e=>{let{avatar:t,columns:n}=e;const s=r();return(0,l.jsx)(l.Fragment,{children:(0,l.jsxs)(i.A,{children:[t&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.A,{style:{paddingRight:0},children:(0,l.jsx)(o.A,{animation:"wave",variant:"circle",width:40,height:40})}),(0,l.jsx)(a.A,{children:(0,l.jsx)(o.A,{animation:"wave",height:30,width:80})})]}),Array.from({length:n},(e,t)=>(0,l.jsx)(a.A,{align:"center",children:(0,l.jsx)("div",{className:s.customTableCell,children:(0,l.jsx)(o.A,{align:"center",animation:"wave",height:30,width:80})})},t))]})})}},49739:(e,t,n)=>{n.d(t,{A:()=>a});const a=n(9950).createContext()},49986:(e,t,n)=>{n.d(t,{A:()=>u});var a=n(80045),i=n(58168),o=n(9950),s=n(2803),l=n(64620),r=n(96287),c="table",d=o.forwardRef(function(e,t){var n=e.classes,l=e.className,d=e.component,u=void 0===d?c:d,m=e.padding,p=void 0===m?"normal":m,h=e.size,A=void 0===h?"medium":h,x=e.stickyHeader,g=void 0!==x&&x,f=(0,a.A)(e,["classes","className","component","padding","size","stickyHeader"]),v=o.useMemo(function(){return{padding:p,size:A,stickyHeader:g}},[p,A,g]);return o.createElement(r.A.Provider,{value:v},o.createElement(u,(0,i.A)({role:u===c?null:"table",ref:t,className:(0,s.A)(n.root,l,g&&n.stickyHeader)},f)))});const u=(0,l.A)(function(e){return{root:{display:"table",width:"100%",borderCollapse:"collapse",borderSpacing:0,"& caption":(0,i.A)({},e.typography.body2,{padding:e.spacing(2),color:e.palette.text.secondary,textAlign:"left",captionSide:"bottom"})},stickyHeader:{borderCollapse:"separate"}}},{name:"MuiTable"})(d)},61510:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Q});var a=n(89379),i=n(9950),o=n(85923),s=n(16673),l=n(69994),r=n(77882),c=n(52816),d=n(49986),u=n(80158),m=n(5386),p=n(37874),h=n(92560),A=n(97226),x=n(16714),g=n(32018),f=n(59428),v=n(33043),y=n(36386),j=n(86505),b=n(38847),R=n(3863),N=n(45530),C=n(33906),w=n(42239),E=n(29714),T=n(6443),k=n(46493),S=n(18028),M=n(43510),z=n(77766),H=n(96918),D=n(80892),P=n(80877),I=n(41397),W=n(77534),L=n(32988),O=n(12630),V=n(57513),B=n(7692),U=n(39884),F=n(60995),_=n(44414);const q=(0,l.A)(e=>({root:{display:"flex",flexWrap:"wrap"},multFieldLine:{display:"flex","& > *:not(:last-child)":{marginRight:e.spacing(1)}},btnWrapper:{position:"relative"},buttonProgress:{color:k.A[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},formControl:{margin:e.spacing(1),minWidth:120},colorAdorment:{width:20,height:20}})),$=E.Ik().shape({title:E.Yj().required(C.R.t("announcements.dialog.form.required")),text:E.Yj().required(C.R.t("announcements.dialog.form.required"))}),Y=e=>{let{open:t,onClose:n,announcementId:s,reload:l}=e;const r=q(),d={title:"",text:"",priority:3,status:!0},[u,m]=(0,i.useState)(!1),[p,h]=(0,i.useState)(d),[x,f]=(0,i.useState)(null),y=(0,i.useRef)(null);(0,i.useEffect)(()=>{try{(async()=>{if(!s)return;const{data:e}=await N.A.get("/announcements/".concat(s));h(t=>(0,a.A)((0,a.A)({},t),e))})()}catch(e){(0,W.A)(e)}},[s,t]);const j=()=>{h(d),f(null),n()};return(0,_.jsxs)("div",{className:r.root,children:[(0,_.jsx)(F.A,{title:C.R.t("announcements.confirmationModal.deleteTitle"),open:u,onClose:()=>m(!1),onConfirm:async()=>{x&&(f(null),y.current.value=null),p.mediaPath&&(await N.A.delete("/announcements/".concat(p.id,"/media-upload")),h(e=>(0,a.A)((0,a.A)({},e),{},{mediaPath:null})),o.oR.success(C.R.t("announcements.toasts.deleted")),"function"==typeof l&&l())},children:C.R.t("announcements.confirmationModal.deleteMessage")}),(0,_.jsxs)(S.A,{open:t,onClose:j,maxWidth:"xs",fullWidth:!0,scroll:"paper",children:[(0,_.jsx)(H.A,{id:"form-dialog-title",children:"".concat(s?C.R.t("announcements.dialog.edit"):C.R.t("announcements.dialog.add"))}),(0,_.jsx)("div",{style:{display:"none"},children:(0,_.jsx)("input",{type:"file",accept:".png,.jpg,.jpeg",ref:y,onChange:e=>(e=>{const t=(0,I.head)(e.target.files);t&&f(t)})(e)})}),(0,_.jsx)(T.l1,{initialValues:p,enableReinitialize:!0,validationSchema:$,onSubmit:(e,t)=>{setTimeout(()=>{(async e=>{const t=(0,a.A)({},e);try{if(s){if(await N.A.put("/announcements/".concat(s),t),null!=x){const e=new FormData;e.append("file",x),await N.A.post("/announcements/".concat(s,"/media-upload"),e)}}else{const{data:e}=await N.A.post("/announcements",t);if(null!=x){const t=new FormData;t.append("file",x),await N.A.post("/announcements/".concat(e.id,"/media-upload"),t)}}o.oR.success(C.R.t("announcements.toasts.success")),"function"==typeof l&&l()}catch(n){(0,W.A)(n)}j()})(e),t.setSubmitting(!1)},400)},children:e=>{let{touched:t,errors:n,isSubmitting:a,values:i}=e;return(0,_.jsxs)(T.lV,{children:[(0,_.jsx)(z.A,{dividers:!0,children:(0,_.jsxs)(L.A,{spacing:2,container:!0,children:[(0,_.jsx)(L.A,{xs:12,item:!0,children:(0,_.jsx)(T.D0,{as:g.A,label:C.R.t("announcements.dialog.form.title"),name:"title",error:t.title&&Boolean(n.title),helperText:t.title&&n.title,variant:"outlined",margin:"dense",fullWidth:!0})}),(0,_.jsx)(L.A,{xs:12,item:!0,children:(0,_.jsx)(T.D0,{as:g.A,label:C.R.t("announcements.dialog.form.text"),name:"text",error:t.text&&Boolean(n.text),helperText:t.text&&n.text,variant:"outlined",margin:"dense",multiline:!0,rows:7,fullWidth:!0})}),(0,_.jsx)(L.A,{xs:12,item:!0,children:(0,_.jsxs)(O.A,{variant:"outlined",margin:"dense",fullWidth:!0,children:[(0,_.jsx)(V.A,{id:"status-selection-label",children:C.R.t("announcements.dialog.form.status")}),(0,_.jsxs)(T.D0,{as:B.A,label:C.R.t("announcements.dialog.form.status"),placeholder:C.R.t("announcements.dialog.form.status"),labelId:"status-selection-label",id:"status",name:"status",error:t.status&&Boolean(n.status),children:[(0,_.jsx)(U.A,{value:!0,children:"Ativo"}),(0,_.jsx)(U.A,{value:!1,children:"Inativo"})]})]})}),(0,_.jsx)(L.A,{xs:12,item:!0,children:(0,_.jsxs)(O.A,{variant:"outlined",margin:"dense",fullWidth:!0,children:[(0,_.jsx)(V.A,{id:"priority-selection-label",children:C.R.t("announcements.dialog.form.priority")}),(0,_.jsxs)(T.D0,{as:B.A,label:C.R.t("announcements.dialog.form.priority"),placeholder:C.R.t("announcements.dialog.form.priority"),labelId:"priority-selection-label",id:"priority",name:"priority",error:t.priority&&Boolean(n.priority),children:[(0,_.jsx)(U.A,{value:1,children:"Alta"}),(0,_.jsx)(U.A,{value:2,children:"M\xe9dia"}),(0,_.jsx)(U.A,{value:3,children:"Baixa"})]})]})}),(p.mediaPath||x)&&(0,_.jsxs)(L.A,{xs:12,item:!0,children:[(0,_.jsx)(c.A,{startIcon:(0,_.jsx)(P.A,{}),children:x?x.name:p.mediaName}),(0,_.jsx)(A.A,{onClick:()=>m(!0),color:"secondary",children:(0,_.jsx)(v.A,{})})]})]})}),(0,_.jsxs)(M.A,{children:[!x&&!p.mediaPath&&(0,_.jsx)(c.A,{color:"primary",onClick:()=>y.current.click(),disabled:a,variant:"outlined",children:C.R.t("announcements.dialog.buttons.attach")}),(0,_.jsx)(c.A,{onClick:j,color:"secondary",disabled:a,variant:"outlined",children:C.R.t("announcements.dialog.buttons.cancel")}),(0,_.jsxs)(c.A,{type:"submit",color:"primary",disabled:a,variant:"contained",className:r.btnWrapper,children:["".concat(s?C.R.t("announcements.dialog.buttons.add"):C.R.t("announcements.dialog.buttons.edit")),a&&(0,_.jsx)(D.A,{size:24,className:r.buttonProgress})]})]})]})}})]})]})};var X=n(23665),J=n(18957);const G=(e,t)=>{if("LOAD_ANNOUNCEMENTS"===t.type){const n=t.payload,a=[];return(0,I.isArray)(n)&&n.forEach(t=>{const n=e.findIndex(e=>e.id===t.id);-1!==n?e[n]=t:a.push(t)}),[...e,...a]}if("UPDATE_ANNOUNCEMENTS"===t.type){const n=t.payload,a=e.findIndex(e=>e.id===n.id);return-1!==a?(e[a]=n,[...e]):[n,...e]}if("DELETE_ANNOUNCEMENT"===t.type){const n=t.payload,a=e.findIndex(e=>e.id===n);return-1!==a&&e.splice(a,1),[...e]}if("RESET"===t.type)return[]},K=(0,l.A)(e=>({mainPaper:(0,a.A)({flex:1,padding:e.padding,overflowY:"scroll"},e.scrollbarStyles)})),Q=()=>{const e=K(),t=(0,s.useHistory)(),{user:n}=(0,i.useContext)(J.c),[a,l]=(0,i.useState)(!1),[E,T]=(0,i.useState)(1),[k,S]=(0,i.useState)(!1),[M,z]=(0,i.useState)(null),[H,D]=(0,i.useState)(null),[P,I]=(0,i.useState)(!1),[O,V]=(0,i.useState)(!1),[B,U]=(0,i.useState)(""),[q,$]=(0,i.useReducer)(G,[]),Q=(0,i.useContext)(X.d);(0,i.useEffect)(()=>{!async function(){n.super||(o.oR.error(C.R.t("announcements.toasts.info")),setTimeout(()=>{t.push("/")},1e3))}()},[]),(0,i.useEffect)(()=>{$({type:"RESET"}),T(1)},[B]),(0,i.useEffect)(()=>{l(!0);const e=setTimeout(()=>{Z()},500);return()=>clearTimeout(e)},[B,E]),(0,i.useEffect)(()=>{const e=n.companyId,t=Q.getSocket(e);return t.on("company-announcement",e=>{"update"!==e.action&&"create"!==e.action||$({type:"UPDATE_ANNOUNCEMENTS",payload:e.record}),"delete"===e.action&&$({type:"DELETE_ANNOUNCEMENT",payload:+e.id})}),()=>{t.disconnect()}},[Q,n.companyId]);const Z=async()=>{try{const{data:e}=await N.A.get("/announcements/",{params:{searchParam:B,pageNumber:E}});$({type:"LOAD_ANNOUNCEMENTS",payload:e.records}),S(e.hasMore),l(!1)}catch(e){(0,W.A)(e)}};return(0,_.jsxs)(j.A,{children:[(0,_.jsx)(F.A,{title:H&&"".concat(C.R.t("announcements.confirmationModal.deleteTitle")," ").concat(H.name,"?"),open:O,onClose:V,onConfirm:()=>(async e=>{try{e.mediaName&&await N.A.delete("/announcements/".concat(e.id,"/media-upload")),await N.A.delete("/announcements/".concat(e.id)),o.oR.success(C.R.t("announcements.toasts.deleted"))}catch(t){(0,W.A)(t)}D(null),U(""),T(1)})(H),children:C.R.t("announcements.confirmationModal.deleteMessage")}),(0,_.jsx)(Y,{resetPagination:()=>{T(1),Z()},open:P,onClose:()=>{z(null),I(!1)},"aria-labelledby":"form-dialog-title",announcementId:M&&M.id}),(0,_.jsx)(b.A,{children:(0,_.jsxs)(L.A,{style:{width:"99.6%"},container:!0,children:[(0,_.jsx)(L.A,{xs:12,sm:8,item:!0,children:(0,_.jsxs)(R.A,{children:[C.R.t("announcements.title")," (",q.length,")"]})}),(0,_.jsx)(L.A,{xs:12,sm:4,item:!0,children:(0,_.jsxs)(L.A,{spacing:2,container:!0,children:[(0,_.jsx)(L.A,{xs:6,sm:6,item:!0,children:(0,_.jsx)(g.A,{fullWidth:!0,placeholder:C.R.t("announcements.searchPlaceholder"),type:"search",value:B,onChange:e=>{U(e.target.value.toLowerCase())},InputProps:{startAdornment:(0,_.jsx)(f.A,{position:"start",children:(0,_.jsx)(x.A,{style:{color:"gray"}})})}})}),(0,_.jsx)(L.A,{xs:6,sm:6,item:!0,children:(0,_.jsx)(c.A,{fullWidth:!0,variant:"contained",onClick:()=>{z(null),I(!0)},color:"primary",children:C.R.t("announcements.buttons.add")})})]})})]})}),(0,_.jsx)(r.A,{className:e.mainPaper,variant:"outlined",onScroll:e=>{if(!k||a)return;const{scrollTop:t,scrollHeight:n,clientHeight:i}=e.currentTarget;n-(t+100)<i&&T(e=>e+1)},children:(0,_.jsxs)(d.A,{size:"small",children:[(0,_.jsx)(p.A,{children:(0,_.jsxs)(h.A,{children:[(0,_.jsx)(m.A,{align:"center",children:C.R.t("announcements.table.title")}),(0,_.jsx)(m.A,{align:"center",children:C.R.t("announcements.table.priority")}),(0,_.jsx)(m.A,{align:"center",children:C.R.t("announcements.table.mediaName")}),(0,_.jsx)(m.A,{align:"center",children:C.R.t("announcements.table.status")}),(0,_.jsx)(m.A,{align:"center",children:C.R.t("announcements.table.actions")})]})}),(0,_.jsx)(u.A,{children:(0,_.jsxs)(_.Fragment,{children:[q.map(e=>{var t,n;return(0,_.jsxs)(h.A,{children:[(0,_.jsx)(m.A,{align:"center",children:e.title}),(0,_.jsx)(m.A,{align:"center",children:(n=e.priority,1===n?C.R.t("announcements.high"):2===n?C.R.t("announcements.medium"):3===n?C.R.t("announcements.low"):void 0)}),(0,_.jsx)(m.A,{align:"center",children:null!==(t=e.mediaName)&&void 0!==t?t:C.R.t("quickMessages.noAttachment")}),(0,_.jsx)(m.A,{align:"center",children:e.status?C.R.t("announcements.active"):C.R.t("announcements.inactive")}),(0,_.jsxs)(m.A,{align:"center",children:[(0,_.jsx)(A.A,{size:"small",onClick:()=>(e=>{z(e),I(!0)})(e),children:(0,_.jsx)(y.A,{})}),(0,_.jsx)(A.A,{size:"small",onClick:t=>{V(!0),D(e)},children:(0,_.jsx)(v.A,{})})]})]},e.id)}),a&&(0,_.jsx)(w.A,{columns:5})]})})]})})]})}},80158:(e,t,n)=>{n.d(t,{A:()=>m});var a=n(58168),i=n(80045),o=n(9950),s=n(2803),l=n(64620),r=n(49739),c={variant:"body"},d="tbody",u=o.forwardRef(function(e,t){var n=e.classes,l=e.className,u=e.component,m=void 0===u?d:u,p=(0,i.A)(e,["classes","className","component"]);return o.createElement(r.A.Provider,{value:c},o.createElement(m,(0,a.A)({className:(0,s.A)(n.root,l),ref:t,role:m===d?null:"rowgroup"},p)))});const m=(0,l.A)({root:{display:"table-row-group"}},{name:"MuiTableBody"})(u)},80877:(e,t,n)=>{var a=n(24994),i=n(6305);t.A=void 0;var o=i(n(9950)),s=(0,a(n(53209)).default)(o.createElement("path",{d:"M16.5 6v11.5c0 2.21-1.79 4-4 4s-4-1.79-4-4V5c0-1.38 1.12-2.5 2.5-2.5s2.5 1.12 2.5 2.5v10.5c0 .55-.45 1-1 1s-1-.45-1-1V6H10v9.5c0 1.38 1.12 2.5 2.5 2.5s2.5-1.12 2.5-2.5V5c0-2.21-1.79-4-4-4S7 2.79 7 5v12.5c0 3.04 2.46 5.5 5.5 5.5s5.5-2.46 5.5-5.5V6h-1.5z"}),"AttachFile");t.A=s},86505:(e,t,n)=>{n.d(t,{A:()=>l});n(9950);var a=n(69994),i=n(54742),o=n(44414);const s=(0,a.A)(e=>({mainContainer:{flex:1,padding:e.spacing(2),height:"calc(100% - 48px)"},contentWrapper:{height:"100%",overflowY:"hidden",display:"flex",flexDirection:"column"}})),l=e=>{let{children:t}=e;const n=s();return(0,o.jsx)(i.A,{className:n.mainContainer,children:(0,o.jsx)("div",{className:n.contentWrapper,children:t})})}},92560:(e,t,n)=>{n.d(t,{A:()=>u});var a=n(58168),i=n(80045),o=n(9950),s=n(2803),l=n(64620),r=n(49739),c=n(37751),d=o.forwardRef(function(e,t){var n=e.classes,l=e.className,c=e.component,d=void 0===c?"tr":c,u=e.hover,m=void 0!==u&&u,p=e.selected,h=void 0!==p&&p,A=(0,i.A)(e,["classes","className","component","hover","selected"]),x=o.useContext(r.A);return o.createElement(d,(0,a.A)({ref:t,className:(0,s.A)(n.root,l,x&&{head:n.head,footer:n.footer}[x.variant],m&&n.hover,h&&n.selected),role:"tr"===d?null:"row"},A))});const u=(0,l.A)(function(e){return{root:{color:"inherit",display:"table-row",verticalAlign:"middle",outline:0,"&$hover:hover":{backgroundColor:e.palette.action.hover},"&$selected, &$selected:hover":{backgroundColor:(0,c.X4)(e.palette.secondary.main,e.palette.action.selectedOpacity)}},selected:{},hover:{},head:{},footer:{}}},{name:"MuiTableRow"})(d)},96287:(e,t,n)=>{n.d(t,{A:()=>a});const a=n(9950).createContext()}}]);
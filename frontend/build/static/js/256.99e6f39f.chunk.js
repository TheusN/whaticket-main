"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[256],{29256:(t,e,s)=>{s.r(e),s.d(e,{default:()=>J});var a=s(89379),n=s(9950),c=s(85923),i=s(16673),l=s(69994),o=s(77882),r=s(52816),d=s(49986),h=s(80158),u=s(5386),m=s(37874),A=s(92560),p=s(97226),x=s(16714),j=s(32018),g=s(59428),f=s(33043),y=s(36386),L=s(63497),T=s(95197),C=s(86505),S=s(38847),v=s(3863),R=s(45530),b=s(33906),E=s(42239),I=s(29714),k=s(6443),z=s(46493),w=s(18028),N=s(43510),P=s(77766),W=s(96918),O=s(80892),D=s(77534),M=s(44414);const H=(0,l.A)(t=>({root:{display:"flex",flexWrap:"wrap"},multFieldLine:{display:"flex","& > *:not(:last-child)":{marginRight:t.spacing(1)}},btnWrapper:{position:"relative"},buttonProgress:{color:z.A[500],position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12},formControl:{margin:t.spacing(1),minWidth:120}})),_=I.Ik().shape({name:I.Yj().min(2,b.R.t("contactLists.dialog.nameShort")).max(50,b.R.t("contactLists.dialog.nameLong")).required(b.R.t("contactLists.dialog.nameRequired"))}),V=t=>{let{open:e,onClose:s,contactListId:i}=t;const l=H(),o={name:""},[d,h]=(0,n.useState)(o);(0,n.useEffect)(()=>{(async()=>{if(i)try{const{data:t}=await R.A.get("/contact-lists/".concat(i));h(e=>(0,a.A)((0,a.A)({},e),t))}catch(t){(0,D.A)(t)}})()},[i,e]);const u=()=>{s(),h(o)};return(0,M.jsx)("div",{className:l.root,children:(0,M.jsxs)(w.A,{open:e,onClose:u,maxWidth:"xs",fullWidth:!0,scroll:"paper",children:[(0,M.jsx)(W.A,{id:"form-dialog-title",children:"".concat(i?b.R.t("contactLists.dialog.edit"):b.R.t("contactLists.dialog.add"))}),(0,M.jsx)(k.l1,{initialValues:d,enableReinitialize:!0,validationSchema:_,onSubmit:(t,e)=>{setTimeout(()=>{(async t=>{const e=(0,a.A)({},t);try{i?await R.A.put("/contact-lists/".concat(i),e):await R.A.post("/contact-lists",e),c.oR.success(b.R.t("contactList.toasts.success"))}catch(s){(0,D.A)(s)}u()})(t),e.setSubmitting(!1)},400)},children:t=>{let{touched:e,errors:s,isSubmitting:a}=t;return(0,M.jsxs)(k.lV,{children:[(0,M.jsx)(P.A,{dividers:!0,children:(0,M.jsx)("div",{className:l.multFieldLine,children:(0,M.jsx)(k.D0,{as:j.A,label:b.R.t("contactLists.dialog.name"),autoFocus:!0,name:"name",error:e.name&&Boolean(s.name),helperText:e.name&&s.name,variant:"outlined",margin:"dense",fullWidth:!0})})}),(0,M.jsxs)(N.A,{children:[(0,M.jsx)(r.A,{onClick:u,color:"secondary",disabled:a,variant:"outlined",children:b.R.t("contactLists.dialog.cancel")}),(0,M.jsxs)(r.A,{type:"submit",color:"primary",disabled:a,variant:"contained",className:l.btnWrapper,children:["".concat(i?b.R.t("contactLists.dialog.okEdit"):b.R.t("contactLists.dialog.okAdd")),a&&(0,M.jsx)(O.A,{size:24,className:l.buttonProgress})]})]})]})}})]})})};var F=s(60995),q=s(32988),B=s(48484),U=s(23665);const Y=(t,e)=>{if("LOAD_CONTACTLISTS"===e.type){const s=e.payload,a=[];return s.forEach(e=>{const s=t.findIndex(t=>t.id===e.id);-1!==s?t[s]=e:a.push(e)}),[...t,...a]}if("UPDATE_CONTACTLIST"===e.type){const s=e.payload,a=t.findIndex(t=>t.id===s.id);return-1!==a?(t[a]=s,[...t]):[s,...t]}if("DELETE_CONTACTLIST"===e.type){const s=e.payload,a=t.findIndex(t=>t.id===s);return-1!==a&&t.splice(a,1),[...t]}if("RESET"===e.type)return[]},G=(0,l.A)(t=>({mainPaper:(0,a.A)({flex:1,padding:t.spacing(1),overflowY:"scroll"},t.scrollbarStyles)})),J=()=>{const t=G(),e=(0,i.useHistory)(),[s,a]=(0,n.useState)(!1),[l,I]=(0,n.useState)(1),[k,z]=(0,n.useState)(!1),[w,N]=(0,n.useState)(null),[P,W]=(0,n.useState)(null),[O,H]=(0,n.useState)(!1),[_,J]=(0,n.useState)(!1),[K,Q]=(0,n.useState)(""),[X,Z]=(0,n.useReducer)(Y,[]),$=(0,n.useContext)(U.d);(0,n.useEffect)(()=>{Z({type:"RESET"}),I(1)},[K]),(0,n.useEffect)(()=>{a(!0);const t=setTimeout(()=>{(async()=>{try{const{data:t}=await R.A.get("/contact-lists/",{params:{searchParam:K,pageNumber:l}});Z({type:"LOAD_CONTACTLISTS",payload:t.records}),z(t.hasMore),a(!1)}catch(t){(0,D.A)(t)}})()},500);return()=>clearTimeout(t)},[K,l]),(0,n.useEffect)(()=>{const t=localStorage.getItem("companyId"),e=$.getSocket(t);return e.on("company-".concat(t,"-ContactList"),t=>{"update"!==t.action&&"create"!==t.action||Z({type:"UPDATE_CONTACTLIST",payload:t.record}),"delete"===t.action&&Z({type:"DELETE_CONTACTLIST",payload:+t.id})}),()=>{e.disconnect()}},[$]);return(0,M.jsxs)(C.A,{children:[(0,M.jsx)(F.A,{title:P&&"".concat(b.R.t("contactLists.confirmationModal.deleteTitle")," ").concat(P.name,"?"),open:_,onClose:J,onConfirm:()=>(async t=>{try{await R.A.delete("/contact-lists/".concat(t)),c.oR.success(b.R.t("contactLists.toasts.deleted"))}catch(e){(0,D.A)(e)}W(null),Q(""),I(1)})(P.id),children:b.R.t("contactLists.confirmationModal.deleteMessage")}),(0,M.jsx)(V,{open:O,onClose:()=>{N(null),H(!1)},"aria-labelledby":"form-dialog-title",contactListId:w&&w.id}),(0,M.jsx)(S.A,{children:(0,M.jsxs)(q.A,{style:{width:"99.6%"},container:!0,children:[(0,M.jsx)(q.A,{xs:12,sm:8,item:!0,children:(0,M.jsx)(v.A,{children:b.R.t("contactLists.title")})}),(0,M.jsx)(q.A,{xs:12,sm:4,item:!0,children:(0,M.jsxs)(q.A,{spacing:2,container:!0,children:[(0,M.jsx)(q.A,{xs:7,sm:6,item:!0,children:(0,M.jsx)(j.A,{fullWidth:!0,placeholder:b.R.t("contacts.searchPlaceholder"),type:"search",value:K,onChange:t=>{Q(t.target.value.toLowerCase())},InputProps:{startAdornment:(0,M.jsx)(g.A,{position:"start",children:(0,M.jsx)(x.A,{style:{color:"gray"}})})}})}),(0,M.jsx)(q.A,{xs:5,sm:6,item:!0,children:(0,M.jsx)(r.A,{fullWidth:!0,variant:"contained",color:"primary",onClick:()=>{N(null),H(!0)},children:b.R.t("contactLists.buttons.add")})})]})})]})}),(0,M.jsx)(o.A,{className:t.mainPaper,variant:"outlined",onScroll:t=>{if(!k||s)return;const{scrollTop:e,scrollHeight:a,clientHeight:n}=t.currentTarget;a-(e+100)<n&&I(t=>t+1)},children:(0,M.jsxs)(d.A,{size:"small",children:[(0,M.jsx)(m.A,{children:(0,M.jsxs)(A.A,{children:[(0,M.jsx)(u.A,{align:"center",children:b.R.t("contactLists.table.name")}),(0,M.jsx)(u.A,{align:"center",children:b.R.t("contactLists.table.contacts")}),(0,M.jsx)(u.A,{align:"center",children:b.R.t("contactLists.table.actions")})]})}),(0,M.jsx)(h.A,{children:(0,M.jsxs)(M.Fragment,{children:[X.map(t=>(0,M.jsxs)(A.A,{children:[(0,M.jsx)(u.A,{align:"center",children:t.name}),(0,M.jsx)(u.A,{align:"center",children:t.contactsCount||0}),(0,M.jsxs)(u.A,{align:"center",children:[(0,M.jsx)("a",{href:B,download:"planilha.xlsx",children:(0,M.jsx)(p.A,{size:"small",title:"Baixar Planilha Exemplo",children:(0,M.jsx)(T.A,{})})}),(0,M.jsx)(p.A,{size:"small",onClick:()=>{return s=t.id,void e.push("/contact-lists/".concat(s,"/contacts"));var s},children:(0,M.jsx)(L.A,{})}),(0,M.jsx)(p.A,{size:"small",onClick:()=>(t=>{N(t),H(!0)})(t),children:(0,M.jsx)(y.A,{})}),(0,M.jsx)(p.A,{size:"small",onClick:e=>{J(!0),W(t)},children:(0,M.jsx)(f.A,{})})]})]},t.id)),s&&(0,M.jsx)(E.A,{columns:3})]})})]})})]})}},63497:(t,e,s)=>{var a=s(24994),n=s(6305);e.A=void 0;var c=n(s(9950)),i=(0,a(s(53209)).default)(c.createElement("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"}),"People");e.A=i},95197:(t,e,s)=>{var a=s(24994),n=s(6305);e.A=void 0;var c=n(s(9950)),i=(0,a(s(53209)).default)(c.createElement("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}),"GetApp");e.A=i}}]);
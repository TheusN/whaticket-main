"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[236],{28236:(t,e,a)=>{a.r(e),a.d(e,{default:()=>b});var s=a(9950),n=a(69994),c=a(45530),i=a(18957),o=a(25392),r=a(85923),l=a(33906),d=a(16673),u=a(44414);const g=(0,n.A)(t=>({root:{display:"flex",alignItems:"center",padding:t.spacing(1)},button:{background:"#10a110",border:"none",padding:"10px",color:"white",fontWeight:"bold",borderRadius:"5px"}})),b=()=>{const t=g(),e=(0,d.useHistory)(),[a,n]=(0,s.useState)([]);(0,s.useEffect)(()=>{(async()=>{try{var t;const e=null!==(t=(await c.A.get("/tags/kanban")).data.lista)&&void 0!==t?t:[];n(e),await S(y)}catch(e){console.log(e)}})()},[]);const[b,k]=(0,s.useState)({lanes:[]}),[h,p]=(0,s.useState)([]),{user:f}=(0,s.useContext)(i.c),{profile:m,queues:x}=f,y=f.queues.map(t=>t.UserQueue.queueId),S=async t=>{try{const{data:e}=await c.A.get("/ticket/kanban",{params:{queueIds:JSON.stringify(t),showAll:"admin"===m}});p(e.tickets)}catch(e){console.log(e),p([])}},j=t=>{e.push("/tickets/"+t)};(0,s.useEffect)(()=>{(()=>{const e=h.filter(t=>0===t.tags.length),s=[{id:"lane0",title:l.R.t("kanban.open"),label:e.length.toString(),cards:e.map(e=>({id:e.id.toString(),label:"Ticket n\xba "+e.id.toString(),description:(0,u.jsxs)("div",{children:[(0,u.jsxs)("p",{children:[e.contact.number,(0,u.jsx)("br",{}),e.lastMessage]}),(0,u.jsx)("button",{className:t.button,onClick:()=>{j(e.uuid)},children:l.R.t("kanban.seeTicket")})]}),title:e.contact.name,draggable:!0,href:"/tickets/"+e.uuid}))},...a.map(e=>{const a=h.filter(t=>{const a=t.tags.map(t=>t.id);return a.includes(e.id)});return{id:e.id.toString(),title:e.name,label:a.length.toString(),cards:a.map(e=>({id:e.id.toString(),label:"Ticket n\xba "+e.id.toString(),description:(0,u.jsxs)("div",{children:[(0,u.jsxs)("p",{children:[e.contact.number,(0,u.jsx)("br",{}),e.lastMessage]}),(0,u.jsx)("button",{className:t.button,onClick:()=>{j(e.uuid)},children:l.R.t("kanban.seeTicket")})]}),title:e.contact.name,draggable:!0,href:"/tickets/"+e.uuid})),style:{backgroundColor:e.color,color:"white"}}})];k({lanes:s})})()},[a,h]);return(0,u.jsx)("div",{className:t.root,children:(0,u.jsx)(o.Ay,{data:b,onCardMoveAcrossLanes:async(t,e,a)=>{try{await c.A.delete("/ticket-tags/".concat(a)),r.oR.success(l.R.t("kanban.toasts.removed")),await c.A.put("/ticket-tags/".concat(a,"/").concat(e)),r.oR.success(l.R.t("kanban.toasts.added"))}catch(s){console.log(s)}},style:{backgroundColor:"rgba(252, 252, 252, 0.03)"}})})}}}]);